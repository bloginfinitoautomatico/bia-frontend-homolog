<!DOCTYPE html>
<html>
<head>
    <title>Teste Admin Access</title>
</head>
<body>
    <h1>Teste de Acesso Admin</h1>
    <button onclick="testAdminAccess()">Testar Acesso Admin</button>
    <button onclick="testUserInfo()">Verificar Info do Usuário</button>
    <div id="results"></div>
    
    <script>
        async function testUserInfo() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Verificando informações do usuário...</p>';
            
            try {
                const token = localStorage.getItem('auth_token');
                if (!token) {
                    results.innerHTML = '<p>❌ Token não encontrado no localStorage</p>';
                    return;
                }
                
                const response = await fetch('https://api.bloginfinitoautomatico.com/api/auth/user', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    results.innerHTML = `
                        <h3>Informações do Usuário:</h3>
                        <p><strong>Email:</strong> ${user.email}</p>
                        <p><strong>Nome:</strong> ${user.name}</p>
                        <p><strong>is_admin:</strong> ${user.is_admin}</p>
                        <p><strong>is_developer:</strong> ${user.is_developer}</p>
                        <p><strong>Plano:</strong> ${user.plano}</p>
                        <p><strong>Pode acessar admin:</strong> ${user.email === 'adm@bloginfinitoautomatico.com' ? '✅ SIM' : '❌ NÃO'}</p>
                    `;
                } else {
                    results.innerHTML = `<p>❌ Erro ao obter usuário: ${response.status}</p>`;
                }
            } catch (error) {
                results.innerHTML = `<p>❌ Erro: ${error.message}</p>`;
            }
        }
        
        async function testAdminAccess() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testando acesso ao painel financeiro...</p>';
            
            try {
                const token = localStorage.getItem('auth_token');
                if (!token) {
                    results.innerHTML = '<p>❌ Token não encontrado no localStorage</p>';
                    return;
                }
                
                const response = await fetch('https://api.bloginfinitoautomatico.com/api/financial-dashboard', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                results.innerHTML = `
                    <h3>Resultado do Teste Financial Dashboard:</h3>
                    <p><strong>Status:</strong> ${response.status}</p>
                    <p><strong>Status Text:</strong> ${response.statusText}</p>
                `;
                
                if (response.ok) {
                    const data = await response.json();
                    results.innerHTML += `<p><strong>✅ Sucesso!</strong> Dados recebidos</p>`;
                    console.log('Dados:', data);
                } else {
                    const errorText = await response.text();
                    results.innerHTML += `<p><strong>❌ Erro:</strong> ${errorText}</p>`;
                }
                
            } catch (error) {
                results.innerHTML = `<p>❌ Erro: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
